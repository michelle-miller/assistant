---

copyright:
  years: 2015, 2019
lastupdated: "2019-02-28"

subcollection: assistant

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:deprecated: .deprecated}
{:important: .important}
{:note: .note}
{:tip: .tip}
{:pre: .pre}
{:codeblock: .codeblock}
{:screen: .screen}
{:javascript: .ph data-hd-programlang='javascript'}
{:java: .ph data-hd-programlang='java'}
{:python: .ph data-hd-programlang='python'}
{:swift: .ph data-hd-programlang='swift'}
{:table: .aria-labeledby="caption"}

# 對話概觀
{: #dialog-overview}

此對話會使用使用者輸入中所識別的目的，以及應用程式的環境定義來與使用者互動，最後提供有用的回應。
{: shortdesc}

對話會比對目的（使用者所說的內容）與回應（機器人回覆的內容）。回應可能是 `Where can I get some gas?` 這類問題的回答，或是執行打開收音機這類的指令。目的和實體資訊可能足以識別正確的回應，或是對話可能要求使用者提供更多正確回應所需的輸入。例如，如果使用者詢問 `Where can I get some food?`，您可能會想要釐清他們是要在餐廳還是雜貨店吃晚餐還是外帶，依此類推。您可以要求文字回應中有更多詳細資料，並建立一個以上的子節點來處理新的輸入。

<iframe class="embed-responsive-item" id="youtubeplayer" title="對話概觀" type="text/html" width="640" height="390" src="https://www.youtube.com/embed/XkhAMe9gSFU?rel=0" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen> </iframe>

附註：影片持續時間為 15 分鐘；前 5 分鐘包含新增節點的方式。

在 {{site.data.keyword.conversationshort}} 工具中，對話會以圖形方式呈現為樹狀結構。建立一個分支來處理每一個您要交談處理的目的。分支由多個節點組成。

## 對話節點
{: #dialog-overview-nodes}

每一個對話節點至少都包含一個條件及一個回應。

![顯示放入包含陳述式 If: CONDITION, Then: RESPONSE 之方框的使用者輸入](images/node1-empty.png)

- 條件：指定在要觸發的對話中，必須存在於此節點之使用者輸入中的資訊。此資訊通常是特定目的。它也可能是實體類型、實體值或環境定義變數值。如需相關資訊，請參閱[條件](#dialog-overview-conditions)。
- 回應：服務用來回應使用者的詞語。也可以將回應配置成顯示一個選項影像或選項清單，或配置成觸發程式化動作。如需相關資訊，請參閱[回應](#dialog-overview-responses)。

您可以將節點視為具有 if/then 建構：如果此條件為 true，則傳回此回應。

例如，如果服務的自然語言處理程序功能判定使用者輸入包含 `#cupcake-menu` 目的，則會觸發下列節點。因此，在觸發節點時，服務會回應適當的回答。

![顯示使用者詢問 cupcake 特性。If 條件是 #cupcake-menu，而 Then 回應是 cupcake 特性的清單。](images/node1-simple.png)

具有一個條件及回應的單一節點可以處理簡單使用者要求。但是，使用者通常會有更複雜的問題，或需要協助來完成更複雜的作業。您可以新增子節點，要求使用者提供服務所需的任何其他資訊。

![顯示對話中的第一個節點詢問使用者想要的 cupcake 類型（gluten-free 或 regular），而且具有兩個子節點可根據使用者的回答來提供不同的回應。](images/node1-children.png)

## 對話流程
{: #dialog-overview-flow}

服務會從樹狀結構中的第一個節點到最後一個節點來處理您所建立的對話。

![3 個節點旁的箭頭指向下方，顯示對話從第一個節點向最後一個節點流動](images/node-flow-down.png)

在樹狀結構中向下流動時，如果服務發現符合的條件，則會觸發該節點。然後，會沿著已觸發的節點移動，以根據任何子節點條件來檢查使用者輸入。檢查子節點時，會再次從第一個子節點向最後一個子節點移動。

服務的繼續運作方向是在對話樹狀結構中從第一個節點向最後一個節點，沿著每一個已觸發的節點，然後從第一個子節點向最後一個子節點，並沿著每一個已觸發的子節點，直到到達所追蹤分支中的最後一個節點。

![顯示從第一個根節點指向最後一個根節點的箭頭 1、沿著已觸發節點長度指向的箭頭 2，以及從已觸發節點的第一個子節點指向最後一個子節點的箭頭 3。](images/node-flow.png)

在開始建置對話時，您必須決定要包含的分支，以及放置它們的位置。分支的順序十分重要，因為是從第一個到最後一個評估節點。使用其條件符合輸入的第一個根節點；不會觸發樹狀結構中較後面位置的全部節點。

如果服務到達分支尾端，或從所評估的這組現行子節點中找不到評估為 true 的條件，則會跳回到樹狀結構的起點。同樣地，服務會從第一個到最後一個處理根節點。如果沒有任何條件評估為 true，則會傳回樹狀結構中最後一個節點的回應（一般會有一律評估為 true 的特殊 `anything_else` 條件）。

您可以利用下列方式，來中斷標準的第一個到最後一個流程。

- 自訂在處理節點之後會發生的情況。例如，您可以將節點配置為在處理之後直接跳至另一個節點，即使另一個節點位在樹狀結構中較前面的位置。如需相關資訊，請參閱[定義下一步](#dialog-overview-jump-to)。
- 藉由配置條件式回應來跳至其他節點。如需相關資訊，請參閱[條件式回應](#dialog-overview-multiple)。
- 藉由配置對話節點的離題設定值。離題也會影響使用者在執行時期如何在節點之間移動。如果您啟用脫離大部分節點的功能，並配置返回，則使用者可以從某個節點跳至另一個節點，而且可以更輕鬆地返回。如需相關資訊，請參閱[離題](/docs/services/assistant?topic=assistant-dialog-runtime#dialog-runtime-digressions)。

## 條件
{: #dialog-overview-conditions}

節點條件決定是否在交談中使用該節點。回應條件決定要傳回給使用者的回應。

- [條件構件](#dialog-overview-condition-artifacts)
- [特殊條件](#dialog-overview-special-conditions)
- [條件語法詳細資料](#dialog-overview-condition-syntax)

如需在條件中執行其他進階動作的相關提示，請參閱[條件用法提示](/docs/services/assistant?topic=assistant-dialog-tips#dialog-tips-condition-usage-tips)。

### 條件構件
{: #dialog-overview-condition-artifacts}

您可以使用任何組合中的下列其中一個以上構件來定義條件：

- **環境定義變數**：如果所指定的環境定義變數表示式為 true，則會使用節點。請使用語法 `$variable_name:value` 或 `$variable_name == 'value'`。

  如果是節點條件，這個構件類型通常是搭配 AND 或 OR 運算子和另一個條件值來使用。這是因為使用者輸入中的某件事必須觸發節點；而單獨符合的環境定義變數值不足以觸發它。例如，如果使用者輸入物件由於某種原因而設定了環境定義變數值，即會觸發節點。

  請不要根據在其中設定環境定義變數值的相同對話節點中的環境定義變數值，來定義節點條件。
  {: tip}

  如果是回應條件，這個構件類型可以單獨使用。您可以根據特定的環境定義變數值來變更回應。例如，`$city:Boston` 會檢查 `$city` 環境定義變數是否包含值 `Boston`。如果是，則會傳回回應。
  
  如需環境定義變數的相關資訊，請參閱[環境定義變數](/docs/services/assistant?topic=assistant-dialog-runtime#dialog-runtime-context)。

- **實體**：在使用者輸入中辨識到實體的任何值或同義字時，會使用節點。請使用語法 `@entity_name`。例如，`@city` 會檢查是否在使用者輸入中偵測到針對 @city 實體所定義的任何城市名稱。如果是，則會處理節點或回應。

  請考量建立對等節點來處理未辨識到任何實體值或同義字的情況。{: tip}

  如需實體的相關資訊，請參閱[定義實體](/docs/services/assistant?topic=assistant-entities)。

- **實體值**：如果在使用者輸入中偵測到實體值，則會使用節點。請使用語法 `@entity_name:value`，並指定針對實體所定義的值，而不是同義字。例如：`@city:Boston` 會檢查是否在使用者輸入中偵測到特定城市名稱 `Boston`。

  如果您檢查對等節點中是否存在實體，但未指定實體的特定值，則請務必將此節點（檢查特定實體值）放在只檢查實體是否存在的對等節點前面。否則，永遠不會評估此節點。
  {: tip}

  如果實體是具有擷取群組的型樣實體，則您可以檢查特定群組值相符項。例如，您可以使用語法：`@us_phone.groups[1] == '617'`
  如需相關資訊，請參閱[儲存及辨識輸入中的型樣實體群組](/docs/services/assistant?topic=assistant-dialog-tips#dialog-tips-get-pattern-groups)。

- **目的**：最簡單的條件是單一目的。在服務的自然語言處理程序評估使用者的輸入之後，如果節點判定使用者輸入的目的對映至預先定義的目的，即會使用該節點。請使用語法 `#intent_name`。例如，`#weather` 會檢查使用者輸入是否要求天氣預報。如果是，則會處理使用 `#weather` 目的條件的節點。

  如需目的的相關資訊，請參閱[定義目的](/docs/services/assistant?topic=assistant-intents)。

- **特殊條件**：可用來執行一般對話功能之服務所隨附的條件。如需詳細資料，請參閱下一節的**特殊條件**表格。

### 特殊條件
{: #dialog-overview-special-conditions}

|條件語法|說明        |
|----------------------|-------------|
|`anything_else`      |您可以在對話尾端使用此條件，以在使用者輸入不符合任何其他對話節點時進行處理。此條件會觸發 **Anything else** 節點。|
|`conversation_start` |如同 **welcome**，在第一次對話開啟期間，會將此條件評估為 true。與 **welcome** 不同的是，不論應用程式的起始要求是否包含使用者輸入，它都會是 true。具有 **conversation_start** 條件的節點可以用來起始設定環境定義變數，或在對話開頭執行其他作業。|
|`false`              |一律將此條件評估為 false。您可以在開發中分支的開頭使用此條件，以避免它被使用，或是用作提供一般功能之節點的條件，而且只能用作**跳至**動作的目標。|
|`irrelevant`         |如果 {{site.data.keyword.conversationshort}} 服務判定使用者輸入不相關，則會將此條件評估為 true。|
|`true`               |一律將此條件評估為 true。您可以在節點或回應清單尾端使用此條件，以捕捉任何不符合任何先前條件的回應。|
|`welcome`            |只有在應用程式的起始要求不包含任何使用者輸入時，才會在第一次對話開啟期間（交談開始時），將此條件評估為 true。在所有後續對話開啟中，會將它評估為 false。此條件會觸發 **Welcome** 節點。一般而言，使用此條件的節點是用來歡迎使用者，例如，顯示 `Welcome to our Pizza ordering app.` 這類訊息。在透過 Facebook 或 Slack 等頻道進行互動期間，永遠不會處理此節點。|
{: caption="特殊條件" caption-side="top"}

### 條件語法詳細資料
{: #dialog-overview-condition-syntax}

請使用下列其中一個語法選項，在條件中建立有效的表示式：

- 參照目的、實體及環境定義變數的速記表示法。請參閱[存取及評估物件](/docs/services/assistant?topic=assistant-expression-language)。

- 「Spring 表示式 (SpEL)」語言是一種表示式語言，支援在執行時期查詢及操作物件圖形。如需相關資訊，請參閱 [Spring 表示式語言 (SpEL) 語言 ![外部鏈結圖示](../../icons/launch-glyph.svg "外部鏈結圖示")](http://docs.spring.io/spring/docs/current/spring-framework-reference/html/expressions.html){: new_window}。

您可以使用正規表示式來檢查條件的值。例如，若要尋找相符字串，您可以使用 `String.find` 方法。如需詳細資料，請參閱[方法](/docs/services/assistant?topic=assistant-dialog-methods)。

## 回應
{: #dialog-overview-responses}

對話回應定義如何回覆使用者。

您可以使用下列方式來回覆：

- [簡單文字回應](#dialog-overview-simple-text)
- [複合式回應](#dialog-overview-multimedia)
- [條件式回應](#dialog-overview-multiple)

### 簡單文字回應
{: #dialog-overview-simple-text}

如果要提供文字回應，則只需要輸入您要服務向使用者顯示的文字。

![顯示用於顯示使用者詢問 Where are you located 的節點，而且對話回應為 We have no brick and mortar stores! But, with an internet connection, you can shop us from anywhere。](images/response-simple.png)

若要在回應中包括環境定義變數值，請使用語法 `$variable_name` 進行指定。如需相關資訊，請參閱[環境定義變數](/docs/services/assistant?topic=assistant-dialog-runtime#dialog-runtime-context)。例如，如果您知道 $user 環境定義變數設為處理節點之前的現行使用者名稱，則您可以在節點的文字回應中參照它，如下所示：

```
Hello $user
```
{: screen}

如果現行使用者名稱是 `Norman`，則顯示給 Norman 的回應為 `Hello Norman`。

如果您在文字回應中包括其中一個特殊字元，請在它前面加上反斜線 (``\`) 來跳出它。如果您使用的是 JSON 編輯器，則需要使用兩條反斜線來進行跳出 (``\\`)。跳出字元可避免服務將它不當解譯為下列其中一種構件類型：

| 特殊字元 | 構件 |範例|
|-------------------|----------|---------|
| `$` | 環境定義變數 | `The transaction fee is \$2.` |
| `@` | 實體 | `Send us your feedback at feedback\@example.com.` |
{: caption="要在回應中跳出的特殊字元" caption-side="top"}

內建整合支援下列 Markdown 語法元素：

| 格式 | 語法 |範例|
|------------|--------|---------|
| 斜體 | `We're talking about *practice*.` | We're talking about *practice*. |
| 粗體 | `There's **no** crying in baseball.` | There's **no** crying in baseball. |
| 超文字鏈結 | `Contact us at [ibm.com](https://www.ibm.com).` | Contact us at [ibm.com ![外部鏈結圖示](../../icons/launch-glyph.svg "外部鏈結圖示")](https://www.ibm.com). |
{: caption="支援的 Markdown 語法" caption-side="top"}

「試用」窗格目前不支援 Markdown 語法。若要包括「試用」窗格中所呈現的鏈結，並且僅「預覽」鏈結整合，您可以使用 HTML 語法。例如：`Contact us at <a href="https://www.ibm.com">ibm.com</a>.` （例如，請*不要* 嘗試以反斜線 `\"` 來跳出問號。）不過，任何其他內建整合都不支援 HTML 語法。
{: note}

#### 進一步瞭解簡單回應
{: #dialog-overview-variety}

- [新增多行](#dialog-overview-multiline)
- [新增變化](#dialog-overview-add-variety)

#### 新增多行
{: #dialog-overview-multiline}

如果您想要單一文字回應包括多行，並以回車字元區隔，請遵循下列步驟：

1.  將您要向使用者顯示為個別句子的每一行，新增至它自己的回應變異欄位。例如：

  <table>
  <caption>多行回應</caption>
  <tr>
    <th>回應變異</th>
  </tr>
  <tr>
    <td>您好！</td>
  </tr>
  <tr>
    <td>您今天好嗎？</td>
  </tr>
  </table>

1.  對於回應變異設定，請選擇**多行**。

    如果您使用的對話技能是在服務新增複合式回應類型的支援之前所建立，則您可能看不到*多行* 選項。將第二個文字回應類型新增至現行節點回應。此動作會變更在基礎 JSON 中呈現回應的方式。因此，多行選項會變成可供使用。請選擇多行變異類型。現在，您可以刪除新增至回應的第二個文字回應類型。
    {: note}

向使用者顯示回應時，會同時顯示這兩個回應變異，一行顯示一個，如下所示：

```
您好！
您今天好嗎？
```
{: screen}

#### 新增變化
{: #dialog-overview-add-variety}

如果使用者經常回到交談服務，他們可能會覺得每次都聽到相同的問候語及回應十分無聊。您可以對回應新增*變異*，讓交談能夠以不同方式回應相同的狀況。

在此範例中，服務針對回應商店位置問題所提供的回答，在不同互動之間會不同：

![顯示用於顯示使用者詢問 Where are you located 的節點，而且對話已定義三個不同的回應。](images/variety.png)

您可以選擇按順序或以隨機順序來輪替回應變異。依預設，會按順序輪替回應，就像它們是從排序清單中選擇的一樣。

若要變更個別文字回應的傳回順序，請完成下列步驟：

1.  將每個回應變異新增至它自己的回應變異欄位。例如：

  <table>
  <caption>改變回應</caption>
  <tr>
    <th>回應變異</th>
  </tr>
  <tr>
    <td>哈囉！</td>
  </tr>
  <tr>
    <td>您好！</td>
  </tr>
  <tr>
    <td>你好！</td>
  </tr>
  </table>

1.  對於回應變異設定，請選擇下列其中一個設定：

    - **循序**：系統會在第一次觸發對話節點時傳回第一個回應變異，在第二次觸發節點時傳回第二個回應變異，依此類推，如您在節點中定義變異的順序。

      處理節點時，會依下列順序傳回回應結果：

      - 第一次：

        ```
        哈囉！
        ```
        {: screen}

      - 第二次：

        ```
        您好！
        ```
        {: screen}

      - 第三次：
        ```
        你好！
        ```
        {: screen}

    - **隨機**：系統會在第一次觸發對話節點時從變異清單中隨機選取一個字串，然後在下一次隨機選取另一個變異，但不會連續重複相同的字串。

      處理節點時，可能的回應傳回順序範例如下：

      - 第一次：

        ```
        你好！
        ```
        {: screen}

      - 第二次：

        ```
        您好！
        ```
        {: screen}

      - 第三次：

        ```
        哈囉！
        ```
        {: screen}

### 複合式回應
{: #dialog-overview-multimedia}

您可以傳回具有多媒體或互動式元素（例如，影像或者可按式按鈕）的回應，以簡化應用程式的互動模型且加強使用者體驗。

除了預設回應類型**文字**之外（亦即，指定要傳回給使用者的文字，以作為回應），還支援下列回應類型：

- **連接至真人服務專員**：![僅限「加值」或「超值」方案 ](images/premium.png) 對話會呼叫您指定的服務，通常是管理真人服務專員支援問題單佇列的服務，以將交談傳遞給人員。您可以選擇包括一則訊息，彙總要提供給真人服務專員的使用者問題。外部服務必須負責向使用者顯示一則訊息，說明交談已被移轉。對話不會管理該通訊本身。當您在「試用」窗格中使用此回應類型測試節點時，不會發生對話移轉。您必須從測試部署中，存取使用此回應類型的節點，才能瞭解使用者的體驗。

  只有在「加值」方案或「超值」方案的服務實例中才顯示此回應類型，而且只有與 Intercom 或自訂應用程式整合搭配使用時才支援此回應類型。
  {: note}

- **影像**：將影像內嵌至回應。來源影像檔必須在某處進行管理，且具有可用來參照它的 URL。它不能是儲存在無法公開存取之目錄中的檔案。
- **選項**：新增一個以上選項的清單。當使用者按一下其中一個選項時，會將關聯的使用者輸入值傳送給服務。選項的呈現方式視對話部署位置而有所不同。例如，在整合頻道中，選項可能顯示為可按式按鈕，但在其他頻道中，可能顯示為下拉清單。
- **暫停**：強制應用程式先等待指定的毫秒數，再繼續進行處理。您可以選擇顯示一個指示器，指出對話運作的同時正在鍵入回應。如果您需要執行可能需要一些時間的動作，請使用此回應類型。例如，母節點進行「雲端功能」呼叫，並在子節點中顯示結果。您可以使用此回應類型作為母節點的回應，讓程式化呼叫有時間完成，然後跳至子節點以顯示結果。「試用」窗格中不會呈現此回應類型。您必須從測試部署中，存取使用此回應類型的節點，才能瞭解使用者的體驗。

#### 新增複合式回應
{: #dialog-overview-multimedia-add}

若要新增複合式回應，請完成下列步驟：

1.  按一下回應欄位中的下拉功能表以選擇回應類型，然後提供任何必要的資訊：

    - **連接至真人服務專員**。![僅限「加值」或「超值」方案](images/premium.png) 您可以選擇新增訊息，以與交談移轉至的真人服務專員共用。

        只有與 Intercom 及自訂應用程式整合搭配使用時，才支援此回應類型。若為自訂應用程式，您必須以程式設計方式，將用戶端應用程式設計成可辨識何時觸發此回應類型。
        {: note}

    - **影像**。將受管理影像檔的完整 URL 新增至**影像來源**欄位。影像格式必須是 .jpg、.gif 或 .png。影像檔必須儲存在可用 URL 公開定址的位置。

        例如：`https://www.example.com/assets/common/logo.png`。

        如果您想要在回應中的內嵌影像上方顯示影像標題和說明，則請在提供的欄位中新增這些項目。

        Slack 整合需要標題。其他整合頻道會忽略標題或說明。
        {: note}

    - **選項**。請完成下列步驟：

      1.  按一下**新增選項**。
      1.  在**清單標籤**欄位中，輸入要顯示在清單中的選項。標籤的長度必須少於 64 個字元。
      1.  在對應的**值**欄位中，輸入當選取這個選項時，要傳遞給服務的使用者輸入。值的長度必須少於 2,048 個字元。（現行限制採用 64 個字元的限制，但正在解決中。）

          指定您知道會在提交時觸發正確目的的值。例如，可能是目的訓練資料中的使用者範例。
      1.  重複先前的步驟，以在清單中新增其他選項。
      1.  在**標題**欄位中新增一份清單簡介。標題可以要求使用者從選項清單中挑選。

          部分整合頻道不會顯示標題。
          {: note}

      1.  選擇性地在**說明**欄位中新增其他資訊。如果已指定，則會在標題後面、選項清單前面顯示說明。

      部分整合頻道不會顯示說明。
      {: note}

      例如，您可以建構如下所示的回應：

        <table>
        <caption>回應選項</caption>
        <tr>
          <th>清單標題</th>
          <th>清單說明</th>
          <th>選項標籤</th>
          <th>按一下時提交的使用者輸入</th>
        </tr>
        <tr>
          <td>保險類型</td>
          <td>您要保障下列哪些項目？</td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>船隻</td>
          <td>我想要購買船隻保險</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>汽車</td>
          <td>我想要購買汽車保險</td>
        </tr>
         <tr>
          <td></td>
          <td></td>
          <td>家居</td>
          <td>我想要購買家居保險</td>
        </tr>
        </table>

    - **暫停**。將暫停的持續時間長度（毫秒）新增至**持續時間**欄位。

        此值不得超出 10,000 毫秒。使用者通常願意等待 8 秒（8,000 毫秒）左右，讓某人輸入回應。若要防止在暫停期間顯示鍵入指示器，請選擇**關閉**。

        在暫停之後新增另一個回應類型（例如，文字回應類型），以明確表示暫停已結束。{: tip}

    - **文字**。在文字欄位中，新增要傳回給使用者的文字。選擇性地選擇文字回應的變異設定。如需詳細資料，請參閱[簡單文字回應](#dialog-overview-simple-text)。

1.  按一下**新增回應**，將另一個回應類型新增至現行回應。

    您可能想要將多種回應類型新增至單一回應，以為使用者查詢提供更豐富的答案。例如，如果使用者要求商店位置，您可以顯示一張地圖，並針對每個商店位置顯示一個按鈕，供使用者點選以取得地址詳細資料。若要建置該類型回應，您可以使用影像、選項及文字回應類型的組合。另一個範例是在暫停回應類型之前使用文字回應類型，如此您就可以在暫停對話之前，先行警告使用者。

    您無法將 5 個以上的回應類型新增至單一回應。意思是，如果您為對話節點定義 3 個條件式回應，則每個條件式回應都可以新增不超過 5 個回應類型。
    {: note}

    單一對話節點不能有多個**連接至真人服務專員**回應。
    {: note}

1.  如果您新增了多個回應類型，可以按一下**上移**或下移鍵，依您想要服務處理它們的順序來排列回應類型。

### 條件式回應
{: #dialog-overview-multiple}

單一對話節點可以提供不同的回應，每一個回應都是由不同的條件所觸發。您可以使用此方法來處理單一節點中的多種情境。

<iframe class="embed-responsive-item" id="youtubeplayer1" title="新增條件式回應" type="text/html" width="640" height="390" src="https://www.youtube.com/embed/Q5_-f7_Iyvg?rel=0" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen> </iframe>

節點仍然有一個主要條件，這是使用節點以及處理其所包含條件和回應的條件。

在此範例中，服務會使用先前所收集的使用者位置資訊來修改其回應，並提供離使用者最近之商店的相關資訊。如需如何儲存收集自使用者之資訊的相關資訊，請參閱[環境定義變數](/docs/services/assistant?topic=assistant-dialog-runtime#dialog-runtime-context)。

![顯示用於顯示使用者詢問 Where are you located 的節點，而且對話有三個不同的回應（取決的條件是使用 $state 環境定義變數中的資訊來指定那些州中的位置）。](images/multiple-responses.png)

這個單一節點現在提供四個不同節點的對等功能。

若要新增條件式回應至節點，請完成下列步驟：

1.  按一下**自訂**，然後按一下**多個回應**切換開關，將其**開啟**。

    節點回應區段會變更，以顯示一對條件和回應欄位。您可以在其中新增條件及回應。
1.  若要進一步自訂回應，請按一下回應旁的**編輯回應** ![編輯回應](images/edit-slot.png) 圖示。

    您必須開啟回應以進行編輯，才能完成下列作業：

    - **更新環境定義**。若要變更觸發回應時的環境定義變數值，請在環境定義編輯器中指定環境定義值。您可以更新每個個別條件式回應的環境定義；沒有任何一個一般環境定義編輯器或 JSON 編輯器適用於所有條件式回應。
    - **新增複合式回應**。若要新增多個文字回應，或將文字回應以外的回應類型新增至單一條件式回應，您必須開啟編輯回應視圖。
    - **配置跳躍**。若要指示服務在處理此條件式回應之後跳至另一個節點，請從回應編輯視圖的*最後* 區段中，選取**跳至**。識別您希望服務下一次進行處理的節點。如需相關資訊，請參閱[配置跳至動作](#dialog-overview-jump-to-config)。

      在處理所有條件式回應之前，不會處理針對節點所配置的**跳至**動作。因此，如果條件式回應配置為跳至另一個節點，且已觸發該條件式回應，則永遠不會處理針對節點所配置的跳躍，因此不會發生。

1.  按一下**新增回應**，以新增另一個條件式回應。

會依序評估節點內的條件，就像評估節點一樣。請確定以正確的順序列出條件式回應。如果您需要變更順序，請選取條件及回應配對，然後使用顯示的箭頭，在清單中上下移動。

## 定義下一步
{: #dialog-overview-jump-to}

做出指定的回應之後，您可以指示服務執行下列其中一項作業：

- **等待使用者輸入**：服務會等待使用者提供回應所引起的新輸入。例如，回應可能會向使用者詢問「是/否」問題。除非使用者提供其他輸入，否則不會進行對話。
- **跳過使用者輸入**：如果您不要等待使用者輸入，而是改為直接移至現行節點的第一個子節點，請使用此選項。

  現行節點必須至少有一個子節點，才能使用這個選項。
  {: note}

- **跳至另一個對話節點**：想要交談直接移至完全不同的對話節點時，請使用此選項。例如，您可以使用*跳至* 動作，讓流程從樹狀結構中的多個位置遞送至一般對話節點。

  您要跳至的目標節點必須存在，才能配置「跳至」動作來使用該節點。
  {: note}

### 配置跳至動作
{: #dialog-overview-jump-to-config}

如果您選擇跳至另一個節點，請選擇下列其中一個選項，以指定何時處理目標節點：

- **條件**：如果陳述式的目標設為所選取對話節點的條件區段，則服務會先檢查目標節點的條件是否評估為 true。
    - 如果條件評估為 true，則系統會立即處理目標節點。
    - 如果條件未評估為 true，則系統會移至目標節點的下一個同層級節點來評估其條件，然後重複此處理程序，直到找到將條件評估為 true 的對話節點。

    - 如果系統處理所有同層級，而且沒有任何條件評估為 true，則會使用基本備用策略，而且對話會評估位於對話樹狀結構起點的節點。

    將目標設為條件適用於鏈結對話節點的條件。例如，您可能要先檢查輸入是否包含目的（例如 `#turn_on`），而且，如果包含目的，則您可能要檢查輸入是否包含實體（例如 `@lights`、`@radio` 或 `@wipers`）。鏈結條件有助於建構較大的對話樹狀結構。

    配置從條件式回應執行的跳至動作時，若要跳至對話樹狀結構中現行節點上方的節點，請避免選擇這個選項。否則，您會建立一個無限迴圈。如果服務跳至較早的節點，並檢查其條件，則可能會傳回 false，因為正在評估上次透過對話觸發現行節點的相同使用者輸入。服務會移至下一個同層級或回到根節點，以檢查那些節點上的條件，且可能會結束再次觸發此節點，這表示程序會自己重複。
    {: note}

- **回應**：如果陳述式的目標設為所選取對話節點的回應區段，則會立即執行。亦即，系統不會評估所選取對話節點的條件；它會立即處理所選取對話節點的回應。

  將目標設為回應適用於將數個對話節點鏈結在一起。如果這個對話節點的條件是 true，則會處理回應。如果選取的對話節點有另一個**跳至**動作，則也會立即執行該動作。

- **等待使用者輸入**：等待使用者的新輸入，然後從您跳至的節點開始處理該輸入。例如，如果來源節點提問，且您想要跳至個別的節點來處理使用者對該問題的答案，則此選項非常實用。

## 相關資訊

如需對話所使用表示式語言的相關資訊，以及方法、系統實體和其他有用詳細資料，請參閱導覽窗格中的**參照**區段。

您也可以使用 API 來新增節點，或以其他方式編輯對話。如需相關資訊，請參閱[使用 API 修改對話](/docs/services/assistant?topic=assistant-api-dialog-modify)。
