---

copyright:
  years: 2015, 2019
lastupdated: "2019-02-28"

subcollection: assistant

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:deprecated: .deprecated}
{:important: .important}
{:note: .note}
{:tip: .tip}
{:pre: .pre}
{:codeblock: .codeblock}
{:screen: .screen}
{:javascript: .ph data-hd-programlang='javascript'}
{:java: .ph data-hd-programlang='java'}
{:python: .ph data-hd-programlang='python'}
{:swift: .ph data-hd-programlang='swift'}

# 会話からの学習
{: #logs}

このダイアログ・スキルを使用するアシスタントとユーザーの間のメッセージのリストを開くには、ナビゲーション・バーの**「ユーザーの会話 (User conversations)」**を選択します。
{: shortdesc}

**「ユーザーの会話 (User conversations)」**ページを開くと、デフォルトの表示では、最後の日の結果が最新の結果を先頭にしてリストされます。 該当メッセージで使用された上位インテント (#intent) と認識されたエンティティー (@entity) の値およびメッセージ・テキストが表示されます。 インテントが認識されなかった場合は、*「不適当 (Irrelevant)」*という値が表示されます。 エンティティーが認識されなかった場合や指定されなかった場合は、*「エンティティー不検出 (No entities found)」*という値が表示されます。
![ログのデフォルト・ページ](images/logs_page1.png)

**「ユーザーの会話 (User conversations)」**ページには、ユーザーとアプリケーションの間の*メッセージ* の総数が表示されることに注意してください。 メッセージとは、ユーザーがアプリケーションに送信する単一の発話です。一般には、各会話は複数のメッセージで構成されます。 そのため、この**「ユーザーの会話 (User conversations)」**ページの結果の数は、[「概要」](/docs/services/assistant?topic=assistant-logs-overview)ページに表示される会話の数と異なります。

## ログの制限
{: #logs-limits}

メッセージの保持期間は、{{site.data.keyword.conversationshort}} のサービス・プランに応じて異なります。

  サービス・プラン                         | チャット・メッセージの保持期間
  ------------------------------------ | ------------------------------------
  プレミアム                              | 過去 90 日間
   プラス             | 過去 30 日間
  標準                             | 過去 30 日間
  ライト                                 | 過去 7 日間

## メッセージのフィルタリング
{: #logs-filter-messages}

メッセージは、*「ユーザーのステートメントを検索 (Search user statements)」*、*「インテント (Intents)」*、*「エンティティー (Entities)」*、および*「過去* n *日 (Last n days)」*でフィルタリングできます。

*ユーザーのステートメントを検索 (Search user statements)* - 検索バーに単語を入力します。 これは、アプリケーションの応答ではなくユーザーの入力を検索します。

*インテント (Intents)* - ドロップダウン・メニューを選択して入力フィールドにインテントを入力するか、インテントが取り込まれたリストから選択します。 インテントは複数選択できます。その場合、結果は、選択したインテントのいずれかによってフィルタリングされます (*「不適当 (Irrelevant)」*も含まれます)。

![「インテント (Intents)」ドロップダウン・メニュー](images/intents_filter.png)

*エンティティー (Entities)* - ドロップダウン・メニューを選択して入力フィールドにエンティティー名を入力するか、エンティティーが取り込まれたリストから選択します。 エンティティーは複数選択できます。その場合、結果は、選択したエンティティーのいずれかによってフィルタリングされます。 インテント*と*エンティティーでフィルタリングすると、結果は両方の値を含むメッセージになります。 また、結果を*「エンティティー不検出 (No entities found)」*でフィルタリングすることもできます。

![「エンティティー (Entities)」ドロップダウン・メニュー](images/entities_filter.png)

メッセージが更新されるまで少し時間がかかる場合があります。 ユーザーとアプリケーションの対話の後に少なくとも 30 分空けてから、そのコンテンツを抽出するためのフィルタリングを試行してください。

## それぞれのメッセージを表示する
{: #logs-see-message}

それぞれのメッセージのエントリーを展開して、ユーザーが会話全体でどのようなことを言い、アプリケーションがどのように回答したかを確認できます。 これを行うには、**「会話を開く (Open conversation)」**を選択します。 その会話内で選択したメッセージに自動的に移動します。

各会話の上部に表示される時間は、お使いのブラウザーのタイム・ゾーンに合わせて現地時間で表示されています。API 呼び出しを通じて同じ会話ログを確認した場合は、この時間はタイム・スタンプとは異なることがあります。API ログ呼び出しは常に UTC で表示されるからです。

![「会話を開く (Open conversation)」パネル](images/open_convo.png)

次に、選択したメッセージの分類を表示することを選択できます。

![分類を表示した「会話を開く (Open conversation)」パネル](images/open_convo_classes.png)

## アシスタント間での改善
{: #logs-deploy-id}

ダイアログ・スキルの作成は反復プロセスです。スキルを開発するときには、*「Try it out」*ペインを使用して、サービスがテスト入力から正しいインテントとエンティティーを認識することを確認し、必要に応じて修正することができます。

「ユーザーの会話 (User conversations)」ページから、スキルをデプロイするために使用したアシスタントとユーザーの間の実際の対話を分析できます。これらの対話に基づいて、修正を加えることで、インテントとエンティティーがダイアログ・スキルによって認識される精度を高めることができます。ユーザーの質問の*仕方* やユーザーが送信する可能性のあるランダムなメッセージを正確に知ることは難しいため、実際の会話を頻繁に分析してダイアログ・スキルを改善することが重要です。

複数のアシスタントが含まれた {{site.data.keyword.conversationshort}} インスタンスについては、場合によっては、いずれかのアシスタントのダイアログ・スキル内のメッセージ・データを使用して、その同じインスタンス内の別のアシスタントで使用されるダイアログ・スキルを改善することが有用なことがあります。

![プレミアム・プランのみ](images/premium0.png) {{site.data.keyword.conversationshort}} プレミアム・ユーザーの場合は、オプションで、さまざまなプレミアム・インスタンスにまたがる複数のアシスタントからログ・データにアクセスすることを許可するようにインスタンスを構成できます。

例えば、*HelpDesk* という {{site.data.keyword.conversationshort}} インスタンスがあるとします。 HelpDesk インスタンスには、実動アシスタントと開発アシスタントの両方が含まれているとします。 開発アシスタントのダイアログ・スキルで作業している場合は、実動アシスタントのメッセージのログを使用して、開発アシスタントのダイアログ・スキルを改善できます。

実動アシスタントに送信されたメッセージのデータを使用している場合でも、開発アシスタントのダイアログ・スキル内で行う編集は、開発アシスタントのダイアログ・スキルのみに影響を与えます。

同様に、同一スキルの複数のバージョンを作成する場合は、1 つのバージョンのメッセージ・データを使用して、別のバージョンのトレーニング・データを改善することもできます。

### データ・ソースの選別
{: #logs-pick-data-source}

*データ・ソース* という語は、お客様とアシスタントまたは (ダイアログ・スキルをデプロイするために使用された) カスタム・アプリケーションの間の会話を集めて作成されたログを指します。

*「分析 (Analytics)」* タブを開くと、ユーザーと現在のダイアログ・スキルの対話によって生成されたメトリックが表示されます。現在のスキルがデプロイされておらず、お客様によって使用されていない場合は、メトリックは表示されません。

ダイアログ・スキル内のメッセージ・データ、またはお客様と対話した異なるアシスタントまたはカスタム・アプリケーションに追加されたスキル・バージョン内のメッセージ・データをメトリックに取り込むには、次の手順を実行します。

1.  **「データ・ソース (Data source)」**フィールドをクリックして、使用する可能性のあるログ・データが含まれたアシスタントのリストを表示します。

    このリストには、デプロイされたアシスタントのうち、自身がアクセスできるアシスタントが含まれています。そのオプションについて詳しくは、[*「デプロイメント ID の表示 (Show deployment IDs)」*の説明](#logs-deployment-id-explained)を参照してください。

1.  データ・ソースを選択します。

選択したデータ・ソースの統計情報が表示されます。

このリストにはスキル・バージョンが含まれていないことに注目してください。特定のスキル・バージョンに関連付けられたデータを取得するには、特定のスキル・バージョンがデプロイ済みアシスタントによって使用された時間フレームを知っている必要があります。アシスタントをデータ・ソースとして選択してから、適切な日付でメトリック・データをフィルタリングできます。

### *「デプロイメント ID の表示 (Show deployment IDs)」*の説明
{: #logs-deployment-id-explained}

V1 バージョンの API を使用するアプリケーションでは、`/message` API を使用して送信される各メッセージ内でデプロイメント ID を指定する必要があります。この ID によって、呼び出し元となったデプロイ済みアプリケーションが識別されます。「分析 (Analytics)」ページでは、このデプロイメント ID を使用して、特定の実動アプリケーションに関連付けられたログを取得して表示できます。

V2 バージョンの API を使用するアシスタントやカスタム・アプリケーションについては、システム ID とスキル ID がそれぞれの /message 呼び出しに自動的に組み込まれるため、デプロイメント ID を使用する代わりにアシスタント名に基づいてデータ・ソースを選択できます。

デプロイメント ID を追加するには、V1 API のユーザーは、次の例のように [context ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://cloud.ibm.com/apidocs/assistant?curl=#get-response-to-user-input){: new_window} の metadata 内に deployment プロパティーを組み込みます。

```json
"context" : {
  "metadata": {
       "deployment": "HelpDesk-Production"
  }
}
```
{: codeblock}

## トレーニング・データの改善
{: #logs-fix-data}

実ユーザーの会話から得られる洞察情報に基づいて、ダイアログ・スキルに関連付けられたモデルを修正します。

別のデータ・ソース内のデータを使用する場合は、モデルに加える改善は現在のダイアログ・スキルのみに適用されます。**「データ・ソース (Data source)」**フィールドには、このダイアログ・スキルを改善するために使用しているメッセージのソースが表示され、ページの上部には変更の適用先のダイアログ・スキルが表示されます。

### インテントの修正
{: #logs-correct-intent}

1.  インテントを修正するには、選択した #intent の横にある![「編集」](images/edit_icon.png)編集アイコンを選択します。
1.  表示されたリストから、この入力に対して適切なインテントを選択します。
    - 入力フィールドに入力し始めると、インテントのリストがフィルタリングされます。
    - また、このメニューから**「不適当としてマークを付ける (Mark as irrelevant)」**を選択することもできます (詳細については、[不適当としてマークを付ける](/docs/services/assistant?topic=assistant-intents#intents-mark-irrelevant)を参照してください)。 また、**「インテントのトレーニングをしない (Do not train on intent)」**を選択して、このメッセージをトレーニングのサンプルとして保存しないようにすることもできます。

    ![インテントを選択する](images/select_intent.png)
1.  **「保存」**を選択します。

    ![インテントを選択する](images/save_intent.png)

    {{site.data.keyword.conversationshort}} サービスでは、ユーザー入力を*そのまま*例としてインテントに追加できます。 インテント・トレーニング・データで例として @entity 参照を使用しており、保存するユーザー・メッセージにトレーニング・データのエンティティー値や同義語が含まれている場合は、後でそのメッセージを編集する必要があります。 保存後に、「インテント (Intents)」ページからメッセージを編集して、参照するエンティティーを置き換えます。 詳細については、[インテントの例としての @Entity の直接参照](/docs/services/assistant?topic=assistant-intents#intents-entity-as-example)を参照してください。
    {: tip}

### エンティティーの値またはシノニムを追加する
{: #logs-add-entity}

1.  エンティティーの値またはシノニムを追加するには、選択した @entity の横にある![「編集」](images/edit_icon.png)編集アイコンを選択します。
1.  **「エンティティーの追加 (Add entity)」**を選択します。

    ![「エンティティーの追加 (Add entity)」 ](images/add_entity.png)
1.  次に、アンダーラインの付いたユーザー入力の中の単語やフレーズを選択します。

    ![エンティティーを選択する](images/select_entity.png)
1.  強調表示したフレーズを値として追加するエンティティーを選択します。
    - 入力フィールドに入力し始めると、エンティティーと値のリストがフィルタリングされます。
    - 強調表示したフレーズを既存の値のシノニムとして追加するには、ドロップダウン・リストから `@entity:value` を選択します。

    ![エンティティーの単語を追加する](images/add_entity_word.png)
1.  **「保存」**を選択します。

    ![エンティティーを保存する](images/add_entity_save.png)
